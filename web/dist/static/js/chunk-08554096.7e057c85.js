(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08554096","chunk-72c723ce","chunk-4ba3d483","chunk-2d0ccb97","chunk-2d237d31","chunk-2d0dacb6","chunk-2d0a4474"],{"0680":function(t,e,r){"use strict";r.r(e),r.d(e,"getDict",(function(){return n}));r("96cf");var a=r("1da1"),i=r("4360"),n=function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["store"].dispatch("dictionary/getDictionary",e);case 2:return t.abrupt("return",i["store"].getters["dictionary/getDictionary"][e]);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},"2b09":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"clearflex"},[r("el-button",{staticClass:"fl-right",attrs:{size:"small",type:"primary"},on:{click:t.authApiEnter}},[t._v("确 定")])],1),r("el-tree",{ref:"apiTree",attrs:{data:t.apiTreeData,"default-checked-keys":t.apiTreeIds,props:t.apiDefaultProps,"default-expand-all":"","highlight-current":"","node-key":"onlyId","show-checkbox":""},on:{check:t.nodeChange}})],1)},i=[],n=(r("d81d"),r("96cf"),r("1da1")),o=r("ade3"),u=r("4ec3"),s=r("6cb5"),c={name:"Apis",props:{row:{default:function(){return{}},type:Object}},data:function(){return{apiTreeData:[],apiTreeIds:[],needConfirm:!1,apiDefaultProps:{children:"children",label:"description"}}},methods:{nodeChange:function(){this.needConfirm=!0},enterAndNext:function(){this.authApiEnter()},buildApiTree:function(t){var e=new Object;t&&t.map((function(t){t.onlyId="p:"+t.path+"m:"+t.method,Object.prototype.hasOwnProperty.call(e,t.apiGroup)?e[t.apiGroup].push(t):Object.assign(e,Object(o["a"])({},t.apiGroup,[t]))}));var r=[];for(var a in e){var i={ID:a,description:a+"组",children:e[a]};r.push(i)}return r},authApiEnter:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.$refs.apiTree.getCheckedNodes(!0),a=[],r&&r.map((function(t){var e={path:t.path,method:t.method};a.push(e)})),e.next=5,Object(s["UpdateCasbin"])({authorityId:t.activeUserId,casbinInfos:a});case 5:i=e.sent,0==i.code&&t.$message({type:"success",message:"api设置成功"});case 7:case"end":return e.stop()}}),e)})))()}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["getAllApis"])();case 2:return r=e.sent,a=r.data.apis,t.apiTreeData=t.buildApiTree(a),e.next=7,Object(s["getPolicyPathByAuthorityId"])({authorityId:t.row.authorityId});case 7:i=e.sent,t.activeUserId=t.row.authorityId,t.apiTreeIds=[],i.data.paths&&i.data.paths.map((function(e){t.apiTreeIds.push("p:"+e.path+"m:"+e.method)}));case 11:case"end":return e.stop()}}),e)})))()}},d=c,l=r("2877"),h=Object(l["a"])(d,a,i,!1,null,null,null);e["default"]=h.exports},"2dbd":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"clearflex",staticStyle:{margin:"18px"}},[r("el-button",{staticClass:"fl-right",attrs:{size:"small",type:"primary"},on:{click:t.authDataEnter}},[t._v("确 定")]),r("el-button",{staticClass:"fl-left",attrs:{size:"small",type:"primary"},on:{click:t.all}},[t._v("全选")]),r("el-button",{staticClass:"fl-left",attrs:{size:"small",type:"primary"},on:{click:t.self}},[t._v("本角色")]),r("el-button",{staticClass:"fl-left",attrs:{size:"small",type:"primary"},on:{click:t.selfAndChildren}},[t._v("本角色及子角色")])],1),r("el-checkbox-group",{on:{change:t.selectAuthority},model:{value:t.dataAuthorityId,callback:function(e){t.dataAuthorityId=e},expression:"dataAuthorityId"}},t._l(t.authoritys,(function(e,a){return r("el-checkbox",{key:a,attrs:{label:e}},[t._v(t._s(e.authorityName))])})),1)],1)},i=[],n=(r("4de4"),r("c975"),r("d81d"),r("96cf"),r("1da1")),o=r("2909"),u=r("fd85"),s={name:"Datas",data:function(){return{authoritys:[],dataAuthorityId:[],needConfirm:!1}},props:{row:{default:function(){return{}},type:Object},authority:{default:function(){return{}},type:Array}},methods:{enterAndNext:function(){this.authDataEnter()},all:function(){this.dataAuthorityId=Object(o["a"])(this.authoritys),this.row.dataAuthorityId=this.dataAuthorityId,this.needConfirm=!0},self:function(){var t=this;this.dataAuthorityId=this.authoritys.filter((function(e){return e.authorityId===t.row.authorityId})),this.row.dataAuthorityId=this.dataAuthorityId,this.needConfirm=!0},selfAndChildren:function(){var t=[];this.getChildrenId(this.row,t),this.dataAuthorityId=this.authoritys.filter((function(e){return t.indexOf(e.authorityId)>-1})),this.row.dataAuthorityId=this.dataAuthorityId,this.needConfirm=!0},getChildrenId:function(t,e){var r=this;e.push(t.authorityId),t.children&&t.children.map((function(t){r.getChildrenId(t,e)}))},authDataEnter:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["setDataAuthority"])(t.row);case 2:r=e.sent,0==r.code&&t.$message({type:"success",message:"资源设置成功"});case 4:case"end":return e.stop()}}),e)})))()},roundAuthority:function(t){var e=this;t&&t.map((function(t){var r={};r.authorityId=t.authorityId,r.authorityName=t.authorityName,e.authoritys.push(r),t.children&&t.children.length&&e.roundAuthority(t.children)}))},selectAuthority:function(){this.row.dataAuthorityId=this.dataAuthorityId,this.needConfirm=!0}},created:function(){var t=this;this.authoritys=[],this.dataAuthorityId=[],this.roundAuthority(this.authority),this.row.dataAuthorityId&&this.row.dataAuthorityId.map((function(e){var r=t.authoritys&&t.authoritys.filter((function(t){return t.authorityId===e.authorityId}))&&t.authoritys.filter((function(t){return t.authorityId===e.authorityId}))[0];t.dataAuthorityId.push(r)}))}},c=s,d=r("2877"),l=Object(d["a"])(c,a,i,!1,null,null,null);e["default"]=l.exports},"4ec3":function(t,e,r){"use strict";r.r(e),r.d(e,"getApiList",(function(){return i})),r.d(e,"createApi",(function(){return n})),r.d(e,"getApiById",(function(){return o})),r.d(e,"updateApi",(function(){return u})),r.d(e,"setAuthApi",(function(){return s})),r.d(e,"getAllApis",(function(){return c})),r.d(e,"deleteApi",(function(){return d}));var a=r("b775"),i=function(t){return Object(a["default"])({url:"/api/getApiList",method:"post",data:t})},n=function(t){return Object(a["default"])({url:"/api/createApi",method:"post",data:t})},o=function(t){return Object(a["default"])({url:"/api/getApiById",method:"post",data:t})},u=function(t){return Object(a["default"])({url:"/api/updateApi",method:"post",data:t})},s=function(t){return Object(a["default"])({url:"/api/setAuthApi",method:"post",data:t})},c=function(t){return Object(a["default"])({url:"/api/getAllApis",method:"post",data:t})},d=function(t){return Object(a["default"])({url:"/api/deleteApi",method:"post",data:t})}},6139:function(t,e,r){},6977:function(t,e,r){"use strict";var a=r("6139"),i=r.n(a);i.a},"6cb5":function(t,e,r){"use strict";r.r(e),r.d(e,"UpdateCasbin",(function(){return i})),r.d(e,"getPolicyPathByAuthorityId",(function(){return n}));var a=r("b775"),i=function(t){return Object(a["default"])({url:"/casbin/updateCasbin",method:"post",data:t})},n=function(t){return Object(a["default"])({url:"/casbin/getPolicyPathByAuthorityId",method:"post",data:t})}},"7f88":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"authority"},[r("div",{staticClass:"button-box clearflex"},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addAuthority("0")}}},[t._v("新增角色")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"tree-props":{children:"children",hasChildren:"hasChildren"},border:"","row-key":"authorityId",stripe:""}},[r("el-table-column",{attrs:{label:"角色id","min-width":"180",prop:"authorityId"}}),r("el-table-column",{attrs:{label:"角色名称","min-width":"180",prop:"authorityName"}}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"460"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(r){return t.opdendrawer(e.row)}}},[t._v("设置权限")]),r("el-button",{attrs:{icon:"el-icon-plus",size:"small",type:"primary"},on:{click:function(r){return t.addAuthority(e.row.authorityId)}}},[t._v("新增子角色")]),r("el-button",{attrs:{icon:"el-icon-copy-document",size:"small",type:"primary"},on:{click:function(r){return t.copyAuthority(e.row)}}},[t._v("拷贝")]),r("el-button",{attrs:{icon:"el-icon-edit",size:"small",type:"primary"},on:{click:function(r){return t.editAuthority(e.row)}}},[t._v("编辑")]),r("el-button",{attrs:{icon:"el-icon-delete",size:"small",type:"danger"},on:{click:function(r){return t.deleteAuth(e.row)}}},[t._v("删除")])]}}])})],1),r("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[r("el-form",{ref:"authorityForm",attrs:{model:t.form,rules:t.rules}},[r("el-form-item",{attrs:{label:"父级角色",prop:"parentId"}},[r("el-cascader",{attrs:{disabled:"add"==t.dialogType,options:t.AuthorityOption,props:{checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},"show-all-levels":!1,filterable:""},model:{value:t.form.parentId,callback:function(e){t.$set(t.form,"parentId",e)},expression:"form.parentId"}})],1),r("el-form-item",{attrs:{label:"角色ID",prop:"authorityId"}},[r("el-input",{attrs:{disabled:"edit"==t.dialogType,autocomplete:"off"},model:{value:t.form.authorityId,callback:function(e){t.$set(t.form,"authorityId",e)},expression:"form.authorityId"}})],1),r("el-form-item",{attrs:{label:"角色姓名",prop:"authorityName"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.authorityName,callback:function(e){t.$set(t.form,"authorityName",e)},expression:"form.authorityName"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:t.enterDialog}},[t._v("确 定")])],1)],1),t.drawer?r("el-drawer",{attrs:{visible:t.drawer,"with-header":!1,size:"40%",title:"角色配置"},on:{"update:visible":function(e){t.drawer=e}}},[r("el-tabs",{staticClass:"role-box",attrs:{"before-leave":t.autoEnter,type:"border-card"}},[r("el-tab-pane",{attrs:{label:"角色菜单"}},[r("Menus",{ref:"menus",attrs:{row:t.activeRow}})],1),r("el-tab-pane",{attrs:{label:"角色api"}},[r("apis",{ref:"apis",attrs:{row:t.activeRow}})],1),r("el-tab-pane",{attrs:{label:"资源权限"}},[r("Datas",{ref:"datas",attrs:{authority:t.tableData,row:t.activeRow}})],1)],1)],1):t._e()],1)},i=[],n=(r("d81d"),r("96cf"),r("1da1")),o=r("fd85"),u=r("d0c0"),s=r("2b09"),c=r("2dbd"),d=r("a4a2"),l={name:"Authority",mixins:[d["default"]],data:function(){var t=function(t,e,r){return/^[0-9]*[1-9][0-9]*$/.test(e)?r():r(new Error("请输入正整数"))};return{AuthorityOption:[{authorityId:"0",authorityName:"根角色"}],listApi:o["getAuthorityList"],drawer:!1,dialogType:"add",activeRow:{},activeUserId:0,dialogTitle:"新增角色",dialogFormVisible:!1,apiDialogFlag:!1,copyForm:{},form:{authorityId:"",authorityName:"",parentId:"0"},rules:{authorityId:[{required:!0,message:"请输入角色ID",trigger:"blur"},{validator:t,trigger:"blur"}],authorityName:[{required:!0,message:"请输入角色名",trigger:"blur"}],parentId:[{required:!0,message:"请选择请求方式",trigger:"blur"}]}}},components:{Menus:u["default"],Apis:s["default"],Datas:c["default"]},methods:{autoEnter:function(t,e){var r=["menus","apis","datas"];e&&this.$refs[r[e]].needConfirm&&(this.$refs[r[e]].enterAndNext(),this.$refs[r[e]].needConfirm=!1)},copyAuthority:function(t){for(var e in this.setOptions(),this.dialogTitle="拷贝角色",this.dialogType="copy",this.form)this.form[e]=t[e];this.copyForm=t,this.dialogFormVisible=!0},opdendrawer:function(t){this.drawer=!0,this.activeRow=t},deleteAuth:function(t){var e=this;this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(o["deleteAuthority"])({authorityId:t.authorityId});case 2:a=r.sent,0==a.code&&(e.$message({type:"success",message:"删除成功!"}),e.getTableData());case 4:case"end":return r.stop()}}),r)})))).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},initForm:function(){this.$refs.authorityForm&&this.$refs.authorityForm.resetFields(),this.form={authorityId:"",authorityName:"",parentId:"0"}},closeDialog:function(){this.initForm(),this.dialogFormVisible=!1,this.apiDialogFlag=!1},enterDialog:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("0"!=t.form.authorityId){e.next=3;break}return t.$message({type:"error",message:"角色id不能为0"}),e.abrupt("return",!1);case 3:t.$refs.authorityForm.validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r){var a,i,n,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=26;break}e.t0=t.dialogType,e.next="add"===e.t0?4:"edit"===e.t0?9:"copy"===e.t0?14:24;break;case 4:return e.next=6,Object(o["createAuthority"])(t.form);case 6:return a=e.sent,0==a.code&&(t.$message({type:"success",message:"添加成功!"}),t.getTableData(),t.closeDialog()),e.abrupt("break",24);case 9:return e.next=11,Object(o["updateAuthority"])(t.form);case 11:return i=e.sent,0==i.code&&(t.$message({type:"success",message:"添加成功!"}),t.getTableData(),t.closeDialog()),e.abrupt("break",24);case 14:return n={authority:{authorityId:"string",authorityName:"string",datauthorityId:[],parentId:"string"},oldAuthorityId:0},n.authority.authorityId=t.form.authorityId,n.authority.authorityName=t.form.authorityName,n.authority.parentId=t.form.parentId,n.authority.dataAuthorityId=t.copyForm.dataAuthorityId,n.oldAuthorityId=t.copyForm.authorityId,e.next=22,Object(o["copyAuthority"])(n);case 22:u=e.sent,0==u.code&&(t.$message({type:"success",message:"复制成功！"}),t.getTableData());case 24:t.initForm(),t.dialogFormVisible=!1;case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})))()},setOptions:function(){this.AuthorityOption=[{authorityId:"0",authorityName:"根角色"}],this.setAuthorityOptions(this.tableData,this.AuthorityOption,!1)},setAuthorityOptions:function(t,e,r){var a=this;this.form.authorityId=String(this.form.authorityId),t&&t.map((function(t){if(t.children&&t.children.length){var i={authorityId:t.authorityId,authorityName:t.authorityName,disabled:r||t.authorityId==a.form.authorityId,children:[]};a.setAuthorityOptions(t.children,i.children,r||t.authorityId==a.form.authorityId),e.push(i)}else{var n={authorityId:t.authorityId,authorityName:t.authorityName,disabled:r||t.authorityId==a.form.authorityId};e.push(n)}}))},addAuthority:function(t){this.initForm(),this.dialogTitle="新增角色",this.dialogType="add",this.form.parentId=t,this.setOptions(),this.dialogFormVisible=!0},editAuthority:function(t){for(var e in this.setOptions(),this.dialogTitle="编辑角色",this.dialogType="edit",this.form)this.form[e]=t[e];this.setOptions(),this.dialogFormVisible=!0}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.pageSize=999,e.next=3,t.getTableData();case 3:case"end":return e.stop()}}),e)})))()}},h=l,p=(r("6977"),r("2877")),f=Object(p["a"])(h,a,i,!1,null,null,null);e["default"]=f.exports},a4a2:function(t,e,r){"use strict";r.r(e);r("4de4");var a=r("5530"),i=(r("96cf"),r("1da1")),n=r("0680");e["default"]={data:function(){return{page:1,total:10,pageSize:10,tableData:[],searchInfo:{}}},methods:{filterDict:function(t,e){var r=this[e+"Options"]&&this[e+"Options"].filter((function(e){return e.value==t}));return r&&r[0]&&r[0].label},getDict:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(n["getDict"])(t);case 2:return a=r.sent,e[t+"Options"]=a,r.abrupt("return",a);case 5:case"end":return r.stop()}}),r)})))()},handleSizeChange:function(t){this.pageSize=t,this.getTableData()},handleCurrentChange:function(t){this.page=t,this.getTableData()},getTableData:function(){var t=arguments,e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var i,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i=t.length>0&&void 0!==t[0]?t[0]:e.page,n=t.length>1&&void 0!==t[1]?t[1]:e.pageSize,r.next=4,e.listApi(Object(a["a"])({page:i,pageSize:n},e.searchInfo));case 4:o=r.sent,0==o.code&&(e.tableData=o.data.list,e.total=o.data.total,e.page=o.data.page,e.pageSize=o.data.pageSize);case 6:case"end":return r.stop()}}),r)})))()}}}},d0c0:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"clearflex"},[r("el-button",{staticClass:"fl-right",attrs:{size:"small",type:"primary"},on:{click:t.relation}},[t._v("确 定")])],1),r("el-tree",{ref:"menuTree",attrs:{data:t.menuTreeData,"default-checked-keys":t.menuTreeIds,props:t.menuDefaultProps,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":""},on:{check:t.nodeChange}})],1)},i=[],n=(r("d81d"),r("45fc"),r("a9e3"),r("96cf"),r("1da1")),o=r("1f27"),u={name:"Menus",props:{row:{default:function(){return{}},type:Object}},data:function(){return{menuTreeData:[],menuTreeIds:[],needConfirm:!1,menuDefaultProps:{children:"children",label:function(t){return t.meta.title}}}},methods:{nodeChange:function(){this.needConfirm=!0},enterAndNext:function(){this.relation()},relation:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.$refs.menuTree.getCheckedNodes(!1,!0),e.next=3,Object(o["addMenuAuthority"])({menus:r,authorityId:t.row.authorityId});case 3:a=e.sent,0==a.code&&t.$message({type:"success",message:"菜单设置成功!"});case 5:case"end":return e.stop()}}),e)})))()}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,a,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["getBaseMenuTree"])();case 2:return r=e.sent,t.menuTreeData=r.data.menus,e.next=6,Object(o["getMenuAuthority"])({authorityId:t.row.authorityId});case 6:a=e.sent,i=a.data.menus,n=[],i.map((function(t){i.some((function(e){return e.parentId===t.menuId}))||n.push(Number(t.menuId))})),t.menuTreeIds=n;case 11:case"end":return e.stop()}}),e)})))()}},s=u,c=r("2877"),d=Object(c["a"])(s,a,i,!1,null,null,null);e["default"]=d.exports},fd85:function(t,e,r){"use strict";r.r(e),r.d(e,"getAuthorityList",(function(){return i})),r.d(e,"deleteAuthority",(function(){return n})),r.d(e,"createAuthority",(function(){return o})),r.d(e,"copyAuthority",(function(){return u})),r.d(e,"setDataAuthority",(function(){return s})),r.d(e,"updateAuthority",(function(){return c}));var a=r("b775"),i=function(t){return Object(a["default"])({url:"/authority/getAuthorityList",method:"post",data:t})},n=function(t){return Object(a["default"])({url:"/authority/deleteAuthority",method:"post",data:t})},o=function(t){return Object(a["default"])({url:"/authority/createAuthority",method:"post",data:t})},u=function(t){return Object(a["default"])({url:"/authority/copyAuthority",method:"post",data:t})},s=function(t){return Object(a["default"])({url:"/authority/setDataAuthority",method:"post",data:t})},c=function(t){return Object(a["default"])({url:"/authority/updateAuthority",method:"put",data:t})}}}]);